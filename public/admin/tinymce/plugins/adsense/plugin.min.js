tinymce.PluginManager.add('adsense', function(editor, url) {
	var openDialog = function () {
		return editor.windowManager.open({
			title: 'Adsense',
			body: {
				type: 'panel',
				items: [
					{
						type: 'selectbox',
						name: 'adsense',
						label: 'Adsense type',
						items: ads.map(getAdsElement)
					},
					{
						type: 'grid', // component type
						columns: 2, // number of columns
						items: [
							{
								type: 'input',
								name: 'width',
								label: 'Width',
								display: 'inline'
							},
							{
								type: 'input',
								name: 'height',
								label: 'Height',
								display: 'inline'
							},
						] // array of panel components
					}
				]
			},
			buttons: [
				{
					type: 'cancel',
					text: 'Close'
				},
				{
					type: 'submit',
					text: 'Add',
					primary: true
				}
			],
			onSubmit: function (api) {
				var data = api.getData();

				var adsEl = `<span class="ads-element mceNotEditable ${data.adsense}">Գովազդ</span>`

				var div = '<div class="mceNotEditable"><p class="mceEditable">' +
						'<span class="ads-el-container d-inline-block mceNotEditable" style="';
				if(data.width) {
					div += `width:${data.width}px;`
				}

				if(data.height) {
					div += `height:${data.height}px;`
				}

				div += `"> ${adsEl} </span></p></div>`;

				// Insert content when the window form is submitted
				editor.insertContent(div);
				api.close();
			}
		});
	};

	// Add a button that opens a window
	editor.ui.registry.addButton('adsense', {
		// icon: 'fa fa-telegram',
		// text: 'Embed',
		text: '<span class="fa fa-handshake-o" style="font-size: 18px; font-family: \'FontAwesome\'" aria-hidden="true"></span>',
		onAction: function () {
			// Open window
			openDialog();
		}
	});



	// Adds a menu item, which can then be included in any menu via the menu/menubar configuration
	editor.ui.registry.addMenuItem('adsense', {
		text: 'Adsense',
		onAction: function() {
			// Open window
			openDialog();
		}
	});

	return {
		getMetadata: function () {
			return  {
				name: 'Adsense',
			};
		}
	};
});


function getAdsElement(el) {
	return { value: el.slug, text: el.name }
}