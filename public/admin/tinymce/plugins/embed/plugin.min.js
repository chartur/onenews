tinymce.PluginManager.add('embed', function(editor, url) {
	var openDialog = function () {
		return editor.windowManager.open({
			title: 'Add Embed',
			body: {
				type: 'panel',
				items: [
					{
						type: 'textarea',
						name: 'Code',
						label: 'Code',
					}
				]
			},
			buttons: [
				{
					type: 'cancel',
					text: 'Close'
				},
				{
					type: 'submit',
					text: 'Add',
					primary: true
				}
			],
			onSubmit: function (api) {
				var data = api.getData();
				console.log(data);

				// Insert content when the window form is submitted
				editor.insertContent(data.Code);
				api.close();
			}
		});
	};

	// Add a button that opens a window
	editor.ui.registry.addButton('embed', {
		icon: 'code-sample',
		// text: 'Embed',
		// text: '<i class="fa fa-file-code-o" aria-hidden="true"></i>',
		onAction: function () {
			// Open window
			openDialog();
		}
	});



	// Adds a menu item, which can then be included in any menu via the menu/menubar configuration
	editor.ui.registry.addMenuItem('embed', {
		text: 'Embed',
		onAction: function() {
			// Open window
			openDialog();
		}
	});

	return {
		getMetadata: function () {
			return  {
				name: 'Embed',
			};
		}
	};
});
